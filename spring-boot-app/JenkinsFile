pipeline{
  agent any

  tools{
    maven 'maven'
  }

  stages{
    stage("Git Checkout"){
      steps{
        git branch: 'main', url: 'https://github.com/pranav0015/jenkins-pipeline-spring-boot'
      }
    }

    stage("Build and Test"){
      steps{
        // spring-boot-pipeline is the pipeline jenkins job name here
        // Jenkins already clones the repo into workspace/spring-boot-pipeline
        sh 'cd spring-boot-app && mvn clean package' 
      }
    }

    stage("Static Code Analysis"){
      steps{
        withSonarQubeEnv('sonarqube-server') {
          sh 'mvn clean verify sonar:sonar'
        }
      }
    }
  
  }
}
